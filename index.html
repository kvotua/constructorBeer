<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pumpkin Ale</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/CustomEase.min.js"></script>
    <script src="https://unpkg.com/lenis@1.0.45/dist/lenis.min.js"></script>
    <link
      href="https://fonts.cdnfonts.com/css/copperplate-cyrillic"
      rel="stylesheet"
    />
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap');
      @import url('https://fonts.cdnfonts.com/css/thegoodmonolith');

      :root {
        /* Colors */
        --color-offwhite: #f8f6f2;
        --color-offblack: #302b27;
        --color-offblack-transparent: rgba(48, 43, 39, 0.2);
        --color-overlay-dark: rgba(0, 0, 0, 0.4);
        --color-pumpkin: #f06a12;

        /* Fonts */
        --font-main: 'Inter', sans-serif;
        --font-mono: 'TheGoodMonolith', sans-serif;
        --font-waldorf: 'Times New Roman', serif;
        --font-copperplate: 'Copperplate Cyrillic', serif;

        /* Transitions */
        --transition-smooth: cubic-bezier(0.16, 1, 0.3, 1);
        --transition-elastic: cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-main);
        background-color: var(--color-offwhite);
        color: var(--color-offblack);
        overflow-x: hidden;
        letter-spacing: -0.02em;
        font-weight: 700;
      }

      /* Dust/Scratches background effect for the entire site */
      body::after {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('https://img.freepik.com/premium-photo/white-dust-scratches-black-background_279525-2.jpg?w=640');
        background-repeat: repeat;
        opacity: 0.5;
        mix-blend-mode: overlay;
        pointer-events: none;
        z-index: 999;
      }

      /* 12-column grid system */
      .grid {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 1rem;
        padding: 0 2rem;
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
      }

      .logo {
        position: absolute;
        top: 2rem;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        max-height: 120px;
        height: auto;
        display: flex;
        align-items: center;
        justify-content: center;
        background: none;
      }

      .logo > img {
        width: 100%;
        height: 120px;
        object-fit: contain;
      }

      .container {
        height: 100vh;
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 1rem;
        padding: 2rem;
        align-items: center;
        justify-items: center;
        perspective: 800px;
      }

      .header {
        grid-column: 4 / span 6;
        text-align: center;
        transform-style: preserve-3d;
        margin-top: 60px;
      }

      .header > * {
        transform-style: preserve-3d;
        backface-visibility: hidden;
        transform-origin: center top;
      }

      .header__illustration {
        height: 100px;
        margin: 30px auto 1.5rem;
        position: relative;
      }

      .header__illustration > img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .header__title {
        margin-bottom: 0.5rem;
        font-size: 2.9rem;
        text-transform: none;
        font-family: var(--font-waldorf);
        color: var(--color-pumpkin);

        line-height: 0.9;
        letter-spacing: -0.02em;
      }

      .header__title::first-letter {
        text-transform: uppercase;
      }

      .subtitle {
        margin-bottom: 2rem;
        font-size: 3.9rem;
        text-transform: none;
        font-family: var(--font-waldorf);
        color: var(--color-pumpkin);
        line-height: 0.8;
        letter-spacing: -0.02em;
      }

      .subtitle::first-letter {
        text-transform: uppercase;
      }

      .header__credits,
      .footer-content__credits {
        margin-top: 2rem;
        text-transform: uppercase;
        font-size: 0.8rem;
        font-family: var(--font-mono);
        grid-column: 4 / span 6;
      }

      .header__brauerei {
        font-family: 'Inter', sans-serif;
        font-weight: 300;
        font-size: 1.1rem;
        color: var(--color-pumpkin);
        margin-bottom: 0.5rem;
        text-transform: none;
      }

      .header__brauerei::first-letter {
        text-transform: uppercase;
      }

      .header__kaliningrad {
        font-family: var(--font-copperplate);
        font-size: 1rem;
        color: var(--color-pumpkin);
        text-transform: none;
      }

      .header__kaliningrad::first-letter {
        text-transform: uppercase;
      }

      .scroll-container {
        position: relative;
        height: 300vh;
      }

      .scroll-container__video-wrapper {
        position: sticky;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1;
      }

      #video-container {
        width: 300px;
        height: 300px;
        overflow: hidden;
        background-color: var(--color-offblack);
        position: relative;
        transition: border-radius 0.3s ease;
        filter: blur(0px);
        clip-path: inset(0 0 0 0);
      }

      #video-container::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0);
        transition: background-color 0.3s ease;
        pointer-events: none;
      }

      video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: relative;
        z-index: 0;
      }

      .video-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--color-offblack-transparent);
        color: var(--color-offwhite);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 2rem;
        clip-path: inset(100% 0 0 0);
        backdrop-filter: blur(8px);
        z-index: 2;
      }

      .video-overlay__caption {
        font-family: var(--font-mono);
        font-size: 0.8rem;
        margin-bottom: 1.5rem;
        transform: translateY(30px);
        text-transform: uppercase;
        letter-spacing: 0.05em;

        top: 2rem;
        left: 0;
        width: 100%;

        text-align: center;
      }

      .video-overlay__content {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
        filter: blur(10px);
        transform: scale(1.1);
        opacity: 1;
      }

      .video-overlay h2 {
        font-size: 2.4rem;
        margin-bottom: 0.5rem;
        transform: translateY(30px);
        text-transform: uppercase;
      }

      .video-overlay p {
        font-size: 1.2rem;
        line-height: 1.8;
        max-width: 32ch;
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 1rem;
        transform: translateY(30px);
      }

      .spacer {
        height: 10vh;
      }

      .footer-content {
        padding: 10rem 0;
        text-align: center;
        margin: 0 auto;
      }

      .footer-content__quote {
        margin-bottom: 3rem;
        line-height: 1.8;
        grid-column: 4 / span 6;
      }

      .footer-content__quote p {
        margin-bottom: 1.5rem;
        max-width: 32ch;
        margin-left: auto;
        margin-right: auto;
      }

      .divider {
        width: 1px;
        height: 80px;
        background-color: var(--color-offblack);
        margin: 4rem auto;
        grid-column: 6 / span 2;
      }

      .mountain-footer {
        height: 50vh;
        position: relative;
        clip-path: inset(100% 0 0 0);
        overflow: hidden;
      }

      .mountain-footer video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .mountain-footer__contact-btn {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 10;
        color: var(--color-offwhite);
        cursor: pointer;
        transition: all 0.3s ease;
        opacity: 0;
        pointer-events: auto;
      }

      .mountain-footer__label {
        font-family: var(--font-mono);
        font-size: 0.75rem;
        text-transform: uppercase;
        margin-bottom: 0.75rem;
        letter-spacing: 0.05em;
      }

      .mountain-footer__email-container {
        position: relative;
        display: inline-block;
      }

      .email-container__email {
        font-size: 0.9rem;
        padding: 0 0.6em;
        position: relative;
        display: inline-block;
      }

      .email-container__left-bracket,
      .email-container__right-bracket {
        transition:
          opacity 0.3s var(--transition-elastic),
          transform 0.3s var(--transition-elastic);
      }

      .email-container__left-bracket {
        margin-right: 3px;
      }

      .email-container__right-bracket {
        margin-left: 3px;
        transition-delay: 0.15s;
      }
    </style>
  </head>
  <body>
    <div class="logo">
      <img src="./assets/ponarth.svg" alt="Pumpkin Ale Logo" />
    </div>

    <div class="container">
      <div class="header">
        <div class="header__illustration">
          <img
            src="https://i.ibb.co/MkxRwWdC/photo-2024-11-23-20-27-20.jpg"
            alt="Pumpkin Illustration"
          />
          <button id="editPic" class="edit-btn">
            <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
          </button>
        </div>
        <button
          id="togglePic"
          class="toggle-btn-img"
          title="Скрыть изображение"
        >
          &mdash;
        </button>
        <h1 class="header__title">
          Pumpkin <br />
          Ale<button id="editTitle" class="edit-btn">
            <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
          </button>
        </h1>
        <div class="header__credits">
          <p class="header__brauerei">
            Brauerei Ponarth
            <button id="editPlace" class="edit-btn">
              <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
            </button>
          </p>
          <p class="header__kaliningrad">
            Калининград
            <button id="editCity" class="edit-btn">
              <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
            </button>
          </p>
        </div>
      </div>
    </div>

    <div class="scroll-container">
      <div class="scroll-container__video-wrapper">
        <div id="video-container">
          <video id="video" autoplay loop muted playsinline>
            <source
              src="https://cdn.cosmos.so/74eaa492-31ae-4550-b5a1-40917d873af5.mp4"
              type="video/mp4"
            />
          </video>
          <button id="editVideo" class="edit-btn">
            <img
              src="./assets/edit.svg"
              alt=""
              class="edit-btn__img edit-btn__img_light"
            />
          </button>
          <div class="video-overlay">
            <div class="video-overlay__caption">THOUGHT VESSEL 01</div>
            <button id="editCaption" class="edit-btn edit-btn__img_light">
              <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
            </button>
            <div class="video-overlay__content">
              <h2 class="video-overlay__title">
                Clarity in Silence
                <button
                  id="editTitleContent"
                  class="edit-btn edit-btn__img_light"
                >
                  <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
                </button>
              </h2>
              <p class="video-overlay__text">
                Design emerges from emptiness. Mental clarity precedes visual
                harmony.
                <button id="editPContent" class="edit-btn edit-btn__img_light">
                  <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
                </button>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="spacer"></div>

    <div class="footer-content grid">
      <div class="footer-content__quote">
        <p>
          Trapped in the wisdom of certainty. Shuttered vision through the lens
          of anxiety. Judgment of the incomplete. Shadows of expectation. Urge
          of control even when creativity should be freed.
          <br /><br />
          Quiet the mind, and you will hear creativity speak. Feel the
          inspiration flowing through moments of stillness. Nourish your
          authentic expression by first emptying your cup.
          <button id="editQuote" class="edit-btn">
            <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
          </button>
        </p>
      </div>
      <div class="divider"></div>
      <div class="footer-content__credits">
        <p class="footer-content__credit">
          A Way of Being
          <br />
          Through Mindful Creation
          <button id="editCredits" class="edit-btn">
            <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
          </button>
        </p>
      </div>
    </div>

    <div class="mountain-footer">
      <video id="footerVideo" loop muted playsinline autoplay>
        <source
          src="https://cdn.cosmos.so/7f099da0-9ab2-49fd-879d-0bdfef258209.mp4"
          type="video/mp4"
        />
      </video>
      <button id="editFooterBg" class="edit-btn edit-btn__img_light">
        <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
      </button>
      <div class="mountain-footer__contact-btn">
        <div class="mountain-footer__label">
          +Get In Touch
          <button id="editFooterLabel" class="edit-btn">
            <img
              src="./assets/edit.svg"
              alt=""
              class="edit-btn__img edit-btn__img_light"
            />
          </button>
        </div>
        <div class="mountain-footer__email-container email-container">
          <span class="email-container__left-bracket">[</span>
          <span class="email-container__email" id="email-copy"
            >hi@filip.fyi
            <button id="editFooterEmail" class="edit-btn edit-btn__img_light">
              <img
                src="./assets/edit.svg"
                alt=""
                class="edit-btn__img"
              /></button
          ></span>
          <span class="email-container__right-bracket">]</span>
        </div>
      </div>
    </div>
    <button id="editBackground" class="edit-btn edit-btn-bg">
      <img src="./assets/edit.svg" alt="" class="edit-btn__img" />
    </button>
    <div id="colorPanel" class="color-panel">
      <div class="color-panel__panel-header panel-header">
        <span>Выбрать цвет фона</span>
        <button class="color-panel__panel-close panel-close">&times;</button>
      </div>

      <div class="color-panel__panel-choose panel-choose">
        <div class="color-panel__bg">
          <input
            type="color"
            id="panelColorInput"
            class="color-panel__panel-input panel-input"
          />
          <button id="resetColorBg">Сбросить</button>
        </div>
        <span>Выбрать цвет элементов</span>
        <div class="color-panel-elements">
          <input
            type="color"
            id="panelColorElementsInput"
            class="color-panel__panel-input panel-input"
          />

          <button id="resetColorElements">Сбросить</button>
        </div>
      </div>
    </div>

    <div id="mediaPanel" class="media-panel">
      <div class="media-panel__panel-header panel-header">
        <span>Выбрать медиа</span>
        <button class="media-panel__panel-close panel-close">&times;</button>
      </div>
      <div class="media-panel__panel-choose_url panel-choose">
        <label for="panelUrlInput">Вставьте ссылку</label>
        <input
          type="url"
          id="panelUrlInput"
          placeholder="https://..."
          class="media-panel__panel-input_url panel-input"
        />
      </div>
      <div class="media-panel__panel-choose_file panel-choose">
        <label for="panelUrlInput">Или прикрепите медиа</label>
        <input
          type="file"
          id="panelFileInput"
          class="media-panel__panel-input_file panel-input"
          accept="image/*, video/*"
        />
      </div>
      <div class="media-panel__panel-actions">
        <button id="panelConfirm" class="media-panel__panel-btn">
          Применить
        </button>
      </div>
    </div>

    <style>
      .panel-header {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .panel-close {
        width: 25px;
        height: 25px;
      }
      .media-panel {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 64%;
        max-width: 350px;

        padding: 10px;
        display: flex;
        flex-direction: column;

        gap: 10px;
        border: 1px solid black;
        background-color: rgba(185, 185, 185, 0.5);

        visibility: hidden;
        z-index: 1000;
      }
      .color-panel {
        position: fixed;
        top: 8%;
        right: 3%;

        width: 80%;
        max-width: 210px;
        padding: 10px;
        display: flex;
        flex-direction: column;

        gap: 10px;
        border: 1px solid black;
        background-color: rgba(185, 185, 185, 0.5);

        visibility: hidden;
        z-index: 1000;
      }
      .color-panel__panel-input {
        width: 150px;
      }
      .color-panel-elements,
      .color-panel__bg {
        display: flex;
      }
      .panel-choose {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }
      .edit-btn__img {
        object-fit: cover;
        width: 100%;
        z-index: 1000;
      }
      .toggle-btn-img {
        border-radius: 50%;
        font-size: 9px;
        width: 30px;
        height: 30px;
        position: absolute;
        border: none;
        right: -33px;
        top: 50px;
        background-color: rgba(185, 185, 185, 0.5);
        text-align: center;
      }
      .edit-btn {
        border-radius: 50%;
        width: 35px;
        height: 35px;
        z-index: 1000;
        background: transparent;
        border: none;
        cursor: pointer;
        position: absolute;
        bottom: 0;
        display: none;
        right: -35px;
        top: -15px;
      }
      .edit-btn-bg {
        display: inline;
        position: fixed;
        top: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        z-index: 1000;
      }
      #editCredits {
        top: 10;
        right: -5px;
      }
      #editPlace {
        top: -20px;
      }
      #editCity {
        top: 10px;
      }
      #editVideo {
        right: 10px;
        top: 10px;
      }

      .edit-btn__img_light {
        filter: brightness(0) invert(1);
      }
      #editCaption {
        top: 2%;
        right: 15%;
      }
      #editPContent {
        right: -20px;
      }
      #editFooterBg {
        top: 0;
        right: 0;
      }
      #editFooterEmail {
        right: -47px;
        top: -10px;
      }
      .header__illustration.hidden {
        display: none;
      }

      .header.image-hidden .toggle-btn-img {
        background-color: rgba(177, 114, 43, 0.137);
        top: -20px;
        right: 85px;
      }

      .header.image-hidden .header__title {
        font-size: 3.5rem;
        margin-top: 1.5rem;
      }

      .header.image-hidden .header__credits {
        margin-top: 1.5rem;
      }
    </style>

    <script>
      const buttonEditBg = document.getElementById(`editBackground`);
      const panelColor = document.getElementById(`colorPanel`);
      const closeBtnColor = document.querySelector(`.color-panel__panel-close`);
      const bgColor = document.getElementById(`panelColorInput`);
      const elementColor = document.getElementById(`panelColorElementsInput`);

      const titleElement = document.querySelector('.header__title');
      const brauereiElement = document.querySelector('.header__brauerei');
      const kaliningradElement = document.querySelector('.header__kaliningrad');
      const resetColorElements = document.getElementById(`resetColorElements`);
      const resetColorBg = document.getElementById(`resetColorBg`);
      const logoElement = document.querySelector('.logo img');

      const togglePicBtn = document.getElementById('togglePic');
      const pumpkinIllustration = document.querySelector(
        '.header__illustration'
      );
      const headerContent = document.querySelector('.header');
      let isImageHidden = false;

      togglePicBtn.addEventListener('click', () => {
        isImageHidden = !isImageHidden;
        if (isImageHidden == true) {
          pumpkinIllustration.classList.add('hidden');
          togglePicBtn.innerHTML = '+';
          togglePicBtn.title = 'Показать изображение';
          headerContent.classList.add('image-hidden');
        } else {
          pumpkinIllustration.classList.remove('hidden');
          togglePicBtn.innerHTML = ' &mdash;';
          togglePicBtn.title = 'Скрыть изображение';

          headerContent.classList.remove('image-hidden');
        }
      });

      resetColorBg.addEventListener(`click`, () => {
        document.body.style.backgroundColor = `#f8f6f2`;
      });
      resetColorElements.addEventListener(`click`, () => {
        titleElement.style.color = `#f06a12`;
        brauereiElement.style.color = `#f06a12`;
        kaliningradElement.style.color = `#f06a12`;
        elementColor.value = '#f06a12';
        updateSvgFilter('#f06a12');
        logoElement.style.filter = 'url(#colorFilter)';
      });

      buttonEditBg.addEventListener(`click`, () => {
        if (panelColor.style.visibility === 'hidden') {
          panelColor.style.visibility = 'visible';
        } else {
          panelColor.style.visibility = 'hidden';
        }
      });
      elementColor.addEventListener(`change`, () => {
        let selectedColor = elementColor.value;
        titleElement.style.color = selectedColor;
        brauereiElement.style.color = selectedColor;
        kaliningradElement.style.color = selectedColor;
        logoElement.style.filter = `url(#colorFilter)`;
        updateSvgFilter(selectedColor);
      });

      function updateSvgFilter(color) {
        let svgFilter = document.getElementById('colorFilter');
        if (!svgFilter) {
          const svg = document.createElementNS(
            'http://www.w3.org/2000/svg',
            'svg'
          );
          svg.style.position = 'absolute';
          svg.style.width = '0';
          svg.style.height = '0';
          svgFilter = document.createElementNS(
            'http://www.w3.org/2000/svg',
            'filter'
          );
          svgFilter.id = 'colorFilter';
          svg.appendChild(svgFilter);
          document.body.appendChild(svg);
        }

        svgFilter.innerHTML = `
              <feFlood flood-color="${color}" result="flood"/>
              <feComposite in="flood" in2="SourceGraphic" operator="in"/>
          `;
      }

      closeBtnColor.addEventListener(`click`, () => {
        panelColor.style.visibility = 'hidden';
      });
      bgColor.addEventListener(`change`, () => {
        let selectedColor = bgColor.value;
        document.body.style.backgroundColor = selectedColor;
        bgColor.value = '#f8f6f2';
      });

      function isElementInViewport(el) {
        const rect = el.getBoundingClientRect();
        return (
          rect.top < window.innerHeight &&
          rect.bottom > 0 &&
          rect.left < window.innerWidth &&
          rect.right > 0
        );
      }

      function updateButtonVisibility(button, element) {
        if (
          isElementInViewport(element) &&
          !element.classList.contains('editing')
        ) {
          button.style.display = 'inline';
        } else {
          button.style.display = 'none';
        }
      }

      function setupButtonVisibility(button, element) {
        updateButtonVisibility(button, element);

        window.addEventListener('scroll', () =>
          updateButtonVisibility(button, element)
        );
        window.addEventListener('resize', () =>
          updateButtonVisibility(button, element)
        );
      }

      function makeEditable(buttonSelector, elementSelector) {
        const button = document.querySelector(buttonSelector);
        const element = document.querySelector(elementSelector);

        setupButtonVisibility(button, element);

        button.addEventListener('click', function Edit() {
          button.style.display = 'none';
          element.contentEditable = true;
          element.style.outline = '2px solid gray';
          element.style.outlineOffset = '2px';
          element.focus();
          element.classList.add('editing');
        });

        element.addEventListener('blur', function saveChange() {
          element.contentEditable = false;
          element.style.outline = 'none';
          element.style.outlineOffset = 'none';
          updateButtonVisibility(button, element);
          element.classList.remove('editing');
          updateButtonVisibility(button, element);
        });
      }

      let currentMediaElement = null;
      const panelMedia = document.getElementById('mediaPanel');
      const input = document.getElementById('panelUrlInput');
      const confirmBtn = document.getElementById('panelConfirm');
      const closeBtn = document.querySelector('.media-panel__panel-close');

      function showMediaPanel(mediaElement) {
        currentMediaElement = mediaElement;
        input.value = mediaElement.src || '';
        panelMedia.style.visibility = 'visible';
        panelMedia.style.opacity = '1';
        input.focus();
      }

      function hideMediaPanel() {
        panelMedia.style.opacity = '0';
        panelMedia.style.visibility = 'hidden';
        currentMediaElement = null;
      }

      function updateMedia() {
        const url = input.value.trim();
        const fileInput = document.getElementById('panelFileInput');

        if (fileInput.files.length > 0) {
          const file = fileInput.files[0];
          const fileURL = URL.createObjectURL(file);

          if (currentMediaElement.tagName === 'VIDEO') {
            currentMediaElement.innerHTML = `<source src="${fileURL}" type="${file.type}">`;
            currentMediaElement.load();
          } else {
            currentMediaElement.src = fileURL;
          }
        } else if (url && currentMediaElement) {
          if (currentMediaElement.tagName === 'VIDEO') {
            currentMediaElement.innerHTML = `<source src="${url}" type="video/mp4">`;
            currentMediaElement.load();
          } else {
            currentMediaElement.src = url;
          }
        }

        hideMediaPanel();
      }
      function makeMediaEditable(buttonSelector, mediaElementSelector) {
        const button = document.querySelector(buttonSelector);
        const mediaElement = document.querySelector(mediaElementSelector);

        setupButtonVisibility(button, mediaElement);

        button.addEventListener('click', () => {
          button.style.display = 'none';
          showMediaPanel(mediaElement);
        });
      }

      document.addEventListener('DOMContentLoaded', function () {
        elementColor.value = '#f06a12';
        bgColor.value = '#f8f6f2';

        updateSvgFilter('#f06a12');
        logoElement.style.filter = 'url(#colorFilter)';

        makeEditable('#editTitle', '.header__title');
        makeEditable('#editPlace', '.header__brauerei');
        makeEditable('#editCity', '.header__kaliningrad');
        makeEditable(`#editTitleContent`, `.video-overlay__title`);

        makeEditable(`#editPContent`, `.video-overlay__text`);
        makeEditable(`#editCaption`, `.video-overlay__caption`);
        makeEditable(`#editQuote`, `.footer-content__quote p`);

        makeEditable(`#editCredits`, `.footer-content__credit`);

        makeEditable(`#editFooterLabel`, `.mountain-footer__label`);
        makeEditable(`#editFooterEmail`, `.email-container__email`);
        // makeMediaEditable('#editLogo', '.logo img');
        makeMediaEditable('#editPic', '.header__illustration img');
        makeMediaEditable('#editVideo', '#video');
        makeMediaEditable(`#editFooterBg`, `#footerVideo`);

        panelConfirm.addEventListener('click', () => {
          updateMedia();
        });

        closeBtn.addEventListener('click', () => {
          hideMediaPanel();
        });
      });
    </script>

    <script>
      // Initialize Lenis for smooth scrolling
      const lenis = new Lenis({
        duration: 0.8,
        easing: t => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
        orientation: 'vertical',
        gestureOrientation: 'vertical',
        smoothWheel: true,
      });

      // Register ScrollTrigger plugin
      gsap.registerPlugin(ScrollTrigger, CustomEase);

      // Sync Lenis with ScrollTrigger
      lenis.on('scroll', ScrollTrigger.update);

      gsap.ticker.add(time => {
        lenis.raf(time * 1000);
      });

      gsap.ticker.lagSmoothing(0);

      // Custom eases
      CustomEase.create('softReveal', '0.5, 0, 0, 1');
      CustomEase.create('smoothBlur', '0.25, 0.1, 0.25, 1');

      // Video animation
      const videoContainer = document.getElementById('video-container');
      const video = document.getElementById('video');
      const videoOverlay = document.querySelector('.video-overlay');
      const overlayCaption = document.querySelector('.video-overlay__caption');
      const overlayContent = document.querySelector(
        '.video-overlay .video-overlay__content'
      );
      const overlayTitle = document.querySelector('.video-overlay h2');
      const overlayTexts = document.querySelectorAll('.video-overlay p');
      const mountainFooter = document.querySelector('.mountain-footer');
      const footerVideo = document.querySelector('.mountain-footer video');

      // Email copy functionality
      const emailBtn = document.querySelector('.mountain-footer__contact-btn');
      const emailElement = document.getElementById('email-copy');
      const originalText = emailElement.textContent;
      let copyTimeout = null;

      // Listen for clicks on the contact button
      // emailBtn.addEventListener('click', function () {
      //   // Copy the email to clipboard
      //   navigator.clipboard
      //     .writeText(originalText)
      //     .then(function () {
      //       // Show success message
      //       emailElement.textContent = 'email copied to clipboard';

      //       // Clear any existing timeout
      //       if (copyTimeout) {
      //         clearTimeout(copyTimeout);
      //       }

      //       // Reset text after 2 seconds
      //       copyTimeout = setTimeout(function () {
      //         emailElement.textContent = originalText;
      //       }, 2000);
      //     })
      //     .catch(function (err) {
      //       console.error('Could not copy text: ', err);
      //     });
      // });

      // Ensure video plays
      video.play().catch(error => {
        console.log('Video play failed: ', error);
      });

      // Create timeline for video animation
      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: '.scroll-container',
          start: 'top top',
          end: 'bottom bottom',
          scrub: 1.2,
          markers: false,
          onEnter: () => video.play(),
        },
      });

      // Create timeline for hero section animation with film roll effect
      const heroTl = gsap.timeline({
        scrollTrigger: {
          trigger: '.container',
          start: 'top top',
          end: 'top+=400 top',
          scrub: 1.2,
          markers: false,
        },
      });

      // Animate each element in the header content with a film roll effect
      gsap.utils.toArray('.header > *').forEach((element, index) => {
        heroTl.to(
          element,
          {
            rotationX: 90,
            y: -30,
            scale: 0.7,
            opacity: 0,
            filter: 'blur(4px)',
            ease: 'power3.inOut',
            transformOrigin: 'center top',
          },
          index * 0.08
        );
      });

      // Create a background overlay for darkening effect
      const overlay = document.createElement('div');
      overlay.style.position = 'absolute';
      overlay.style.top = '0';
      overlay.style.left = '0';
      overlay.style.width = '100%';
      overlay.style.height = '100%';
      overlay.style.backgroundColor = 'rgba(0,0,0,0)';
      overlay.style.pointerEvents = 'none';
      overlay.style.zIndex = '1';
      videoContainer.appendChild(overlay);

      // Animate video container with darkening overlay
      tl.to(
        videoContainer,
        {
          width: '90vw',
          height: '90vh',
          borderRadius: '0',
          ease: 'expo.out',
          duration: 0.5,
        },
        0
      )
        .to(
          video,
          {
            scale: 1.1,
            ease: 'expo.out',
            duration: 0.5,
          },
          0
        )
        .to(
          overlay,
          {
            backgroundColor: 'rgba(0,0,0,0.4)',
            ease: 'power3.inOut',
            duration: 0.5,
          },
          0
        )
        .to(
          videoOverlay,
          {
            clipPath: 'inset(0% 0 0 0)',
            backdropFilter: 'blur(8px)',
            ease: 'expo.out',
            duration: 0.3,
          },
          0.4
        )
        .to(
          overlayCaption,
          {
            transform: 'translateY(0)',
            ease: 'expo.out',
            duration: 0.3,
          },
          0.45
        )
        .to(
          overlayContent,
          {
            filter: 'blur(0px)',
            transform: 'scale(1)',
            ease: 'expo.out',
            duration: 0.4,
          },
          0.45
        );

      // Footer animation
      gsap.to(mountainFooter, {
        scrollTrigger: {
          trigger: '.footer-content',
          start: 'top 80%',
          end: 'top 40%',
          scrub: 1.2,
          onEnter: () => footerVideo.play(),
          markers: false,
        },
        clipPath: 'inset(0% 0 0 0)',
        ease: 'expo.out',
        duration: 1,
      });

      // Contact button animation in footer
      gsap.to('.mountain-footer .mountain-footer__contact-btn', {
        scrollTrigger: {
          trigger: '.mountain-footer',
          start: 'top 60%',
          end: 'top 40%',
          scrub: 0.8,
          markers: false,
        },
        opacity: 1,
        ease: 'expo.out',
        duration: 0.5,
      });

      // Text reveal animations
      gsap.utils.toArray('.footer-content p').forEach(text => {
        gsap.from(text, {
          scrollTrigger: {
            trigger: text,
            start: 'top 85%',
            end: 'top 70%',
            scrub: 1.2,
          },
          y: 15,
          filter: 'blur(5px)',
          ease: 'expo.out',
        });
      });
    </script>
  </body>
</html>
